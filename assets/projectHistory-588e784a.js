const s="metacoding-project-history";const n=()=>{try{const t=localStorage.getItem(s);if(!t)return[];const r=JSON.parse(t);return Array.isArray(r)?r:[]}catch(t){return console.error("读取项目历史失败:",t),[]}},c=t=>{try{const r=n(),e={id:t.projectId||"project_${Date.now()}",name:t.projectId||"未命名项目",template:t.template||"未知模板",timestamp:Date.now(),data:t};r.unshift(e);const o=r.slice(0,20);return localStorage.setItem(s,JSON.stringify(o)),e}catch(r){return console.error("保存项目历史失败:",r),null}},a=t=>{try{const e=n().filter(o=>o.id!==t);return localStorage.setItem(s,JSON.stringify(e)),!0}catch(r){return console.error("删除项目历史失败:",r),!1}},l=()=>{try{return localStorage.removeItem(s),!0}catch(t){return console.error("清除项目历史失败:",t),!1}},i=()=>{const t=n(),r={};t.forEach(o=>{r[o.template]=(r[o.template]||0)+1});const e=t.length>0?t[0]:null;return{total:t.length,templates:r,latest:e?{name:e.name,time:new Date(e.timestamp).toLocaleString()}:null}};export{c as addProjectToHistory,l as clearProjectHistory,n as getProjectHistory,i as getProjectStats,a as removeProjectFromHistory};
